<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DESC Sort Test - Revenue Details</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-info { background: #e7f3ff; padding: 15px; border-radius: 4px; margin-bottom: 20px; }
        .console-output { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 4px; font-family: monospace; height: 200px; overflow-y: auto; }
        .test-data { border: 1px solid #ddd; margin: 10px 0; }
        .test-data th { background: #f5f5f5; padding: 8px; text-align: left; }
        .test-data td { padding: 8px; border-top: 1px solid #eee; }
        .highlight { background: yellow; }
    </style>
</head>
<body>
    <h1>üß™ DESC Sort Test</h1>

    <div class="test-info">
        <h3>Test Purpose:</h3>
        <p>Verify that DESC sorting works correctly for revenue_details.jte</p>
        <ul>
            <li><strong>Issue:</strong> DESC sort showing wrong order (1,3,5,10 instead of 10,5,3,1)</li>
            <li><strong>Fix:</strong> Client-side DESC sorting when server fails</li>
            <li><strong>Expected:</strong> DESC sort shows high to low values</li>
        </ul>
    </div>

    <h3>Test Data:</h3>
    <table class="test-data" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th>T√™n thu·ªëc</th>
                <th>S·ªë l∆∞·ª£ng</th>
                <th>ƒê∆°n gi√°</th>
                <th>Th√†nh ti·ªÅn</th>
            </tr>
        </thead>
        <tbody id="testData">
        </tbody>
    </table>

    <h3>Sort Actions:</h3>
    <button onclick="sortAsc('quantity')">Sort Quantity ASC</button>
    <button onclick="sortDesc('quantity')">Sort Quantity DESC</button>
    <button onclick="sortAsc('price')">Sort Price ASC</button>
    <button onclick="sortDesc('price')">Sort Price DESC</button>

    <h3>Console Output:</h3>
    <div id="console" class="console-output"></div>

    <script>
        // Mock data similar to your revenue details
        const mockData = [
            { drugName: 'Paracetamol 500mg', quantity: 1, price: 30000, totalAmount: 30000 },
            { drugName: 'Paracetamol Vi√™n', quantity: 3, price: 3500, totalAmount: 10500 },
            { drugName: 'Paracetamol H·ªôp', quantity: 3, price: 175000, totalAmount: 525000 },
            { drugName: 'Paracetamol Unknown', quantity: 5, price: 0, totalAmount: 0 },
            { drugName: 'Paracetamol SF', quantity: 10, price: 11000, totalAmount: 110000 },
            { drugName: 'Paracetamol 650mg', quantity: 10, price: 2500, totalAmount: 25000 },
            { drugName: 'Paracetamol Vi', quantity: 11, price: 35000, totalAmount: 385000 },
            { drugName: 'Coldrex 500mg', quantity: 20, price: 6000, totalAmount: 120000 },
            { drugName: 'Unknown Med', quantity: 20, price: 8000, totalAmount: 160000 }
        ];

        let currentData = [...mockData];

        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            logEntry.textContent = `[${timestamp}] ${message}`;
            console.appendChild(logEntry);
            console.scrollTop = console.scrollHeight;
        }

        function renderData() {
            const tbody = document.getElementById('testData');
            tbody.innerHTML = '';

            currentData.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.drugName}</td>
                    <td>${item.quantity}</td>
                    <td>${item.price.toLocaleString('vi-VN')}‚Ç´</td>
                    <td>${item.totalAmount.toLocaleString('vi-VN')}‚Ç´</td>
                `;

                // Highlight first and last rows
                if (index === 0 || index === currentData.length - 1) {
                    row.classList.add('highlight');
                }

                tbody.appendChild(row);
            });
        }

        function sortAsc(field) {
            log(`Sorting ${field} ASC (low to high)`, 'info');

            currentData.sort(function(a, b) {
                const aVal = parseFloat(a[field]) || 0;
                const bVal = parseFloat(b[field]) || 0;
                return aVal - bVal; // ASC
            });

            renderData();

            const first = currentData[0][field];
            const last = currentData[currentData.length - 1][field];
            log(`ASC Result: First=${first}, Last=${last}`, first <= last ? 'success' : 'error');
        }

        function sortDesc(field) {
            log(`Sorting ${field} DESC (high to low)`, 'info');

            currentData.sort(function(a, b) {
                const aVal = parseFloat(a[field]) || 0;
                const bVal = parseFloat(b[field]) || 0;
                return bVal - aVal; // DESC
            });

            renderData();

            const first = currentData[0][field];
            const last = currentData[currentData.length - 1][field];
            log(`DESC Result: First=${first}, Last=${last}`, first >= last ? 'success' : 'error');
        }

        // Initialize
        log('Test initialized with mock data', 'success');
        renderData();

        log('Expected DESC behavior:', 'info');
        log('- Click "Sort Quantity DESC" ‚Üí Should show 20,20,11,10,10,5,3,3,1', 'info');
        log('- First row quantity should be 20, last row should be 1', 'info');

    </script>
</body>
</html>
