<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test POS Customer Default Values</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .form-input:focus { border-color: #007bff; outline: none; }
        .required { color: red; }
        .btn { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .btn:hover { background: #0056b3; }
        .clear-btn { background: #6c757d; margin-left: 5px; }
        .test-result { margin-top: 20px; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        .test-section { border: 1px solid #ddd; padding: 15px; margin: 15px 0; border-radius: 4px; }
        .form-display { background: #f8f9fa; padding: 10px; border-radius: 4px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>üß™ Test POS Customer Default Values</h1>
    <p>Test c√°c t√≠nh nƒÉng:</p>
    <ul>
        <li>‚úÖ Kh√¥ng b·∫Øt bu·ªôc nh·∫≠p t√™n kh√°ch h√†ng (b·ªè required)</li>
        <li>‚úÖ Default "Kh√°ch l·∫ª" n·∫øu t√™n tr·ªëng</li>
        <li>‚úÖ Default "Kh√¥ng c√≥" n·∫øu phone tr·ªëng</li>
        <li>‚úÖ Clear button set default values</li>
        <li>‚úÖ Form validation accept default values</li>
    </ul>

    <div class="test-section">
        <h2>üìù Test Form</h2>
        <form id="testForm">
            <div class="form-group">
                <label class="form-label">T√™n kh√°ch h√†ng</label>
                <input type="text" class="form-input" id="customerName" value="Kh√°ch l·∫ª" placeholder="Kh√°ch l·∫ª" maxlength="100">
                <button type="button" class="btn clear-btn" onclick="clearInput('customerName')">Clear</button>
            </div>

            <div class="form-group">
                <label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                <input type="tel" class="form-input" id="phoneNumber" value="Kh√¥ng c√≥" placeholder="Kh√¥ng c√≥" pattern="^((0|\\+84)[0-9]{9,10}|Kh√¥ng c√≥)$">
                <button type="button" class="btn clear-btn" onclick="clearInput('phoneNumber')">Clear</button>
            </div>

            <div class="form-group">
                <label class="form-label">Ph∆∞∆°ng th·ª©c thanh to√°n <span class="required">*</span></label>
                <select class="form-input" id="paymentMethod" required>
                    <option value="">-- Ch·ªçn ph∆∞∆°ng th·ª©c --</option>
                    <option value="Ti·ªÅn m·∫∑t">Ti·ªÅn m·∫∑t</option>
                    <option value="Chuy·ªÉn kho·∫£n">Chuy·ªÉn kho·∫£n</option>
                </select>
            </div>

            <button type="button" class="btn" onclick="validateAndShowData()">Test Validation & Data</button>
        </form>

        <div class="form-display" id="formData" style="display: none;">
            <h3>üìã Form Data:</h3>
            <pre id="dataDisplay"></pre>
        </div>
    </div>

    <div class="test-section">
        <h2>üîç Test Cases</h2>
        <button type="button" class="btn" onclick="runTest('empty')">Test 1: Empty Fields</button>
        <button type="button" class="btn" onclick="runTest('clear')">Test 2: Clear Buttons</button>
        <button type="button" class="btn" onclick="runTest('manual')">Test 3: Manual Input</button>
        <button type="button" class="btn" onclick="runTest('validation')">Test 4: Validation</button>
    </div>

    <div id="testResults"></div>

    <script>
        console.log('üß™ POS Customer Default Values Test Started');

        // Mock validation functions
        function validateField(fieldId, options) {
            const field = document.getElementById(fieldId);
            const value = field.value.trim();

            if (options.required && !value) {
                console.log(`‚ùå ${fieldId}: Required field is empty`);
                return false;
            }

            if (options.pattern && value && !options.pattern.test(value)) {
                console.log(`‚ùå ${fieldId}: Pattern validation failed for "${value}"`);
                return false;
            }

            if (options.maxLength && value.length > options.maxLength) {
                console.log(`‚ùå ${fieldId}: Max length exceeded`);
                return false;
            }

            console.log(`‚úÖ ${fieldId}: Valid - "${value}"`);
            return true;
        }

        function clearInput(fieldId) {
            const field = document.getElementById(fieldId);
            if (field) {
                // Set default values for customer info fields
                if (fieldId === 'customerName') {
                    field.value = 'Kh√°ch l·∫ª';
                    showResult('info', `üîÑ Cleared ${fieldId} ‚Üí Set to "Kh√°ch l·∫ª"`);
                } else if (fieldId === 'phoneNumber') {
                    field.value = 'Kh√¥ng c√≥';
                    showResult('info', `üîÑ Cleared ${fieldId} ‚Üí Set to "Kh√¥ng c√≥"`);
                } else {
                    field.value = '';
                    showResult('info', `üîÑ Cleared ${fieldId} ‚Üí Empty`);
                }
            }
        }

        function validateForm() {
            // Set default values if empty (like in real pos.js)
            const customerNameInput = document.getElementById('customerName');
            const phoneNumberInput = document.getElementById('phoneNumber');

            if (!customerNameInput.value.trim()) {
                customerNameInput.value = 'Kh√°ch l·∫ª';
            }

            if (!phoneNumberInput.value.trim() || phoneNumberInput.value === 'Kh√¥ng c√≥') {
                phoneNumberInput.value = 'Kh√¥ng c√≥';
            }

            const validations = [
                validateField('customerName', {
                    required: false, // ‚úÖ Not required anymore
                    maxLength: 100
                }),
                validateField('phoneNumber', {
                    required: false, // ‚úÖ Not required
                    pattern: /^((0|\+84)[0-9]{9,10}|Kh√¥ng c√≥)$/ // ‚úÖ Accept "Kh√¥ng c√≥"
                }),
                validateField('paymentMethod', {
                    required: true
                })
            ];

            return validations.every(v => v);
        }

        function validateAndShowData() {
            const isValid = validateForm();

            // Collect form data (like in real pos.js)
            let customerName = document.getElementById('customerName').value.trim();
            let phoneNumber = document.getElementById('phoneNumber').value.trim();

            // Ensure default values
            if (!customerName) customerName = 'Kh√°ch l·∫ª';
            if (!phoneNumber) phoneNumber = 'Kh√¥ng c√≥';

            const formData = {
                customerName: customerName,
                phoneNumber: phoneNumber,
                paymentMethod: document.getElementById('paymentMethod').value,
                isValid: isValid
            };

            document.getElementById('formData').style.display = 'block';
            document.getElementById('dataDisplay').textContent = JSON.stringify(formData, null, 2);

            if (isValid) {
                showResult('success', '‚úÖ Form validation passed! Data ready for submission.');
            } else {
                showResult('warning', '‚ö†Ô∏è Form validation failed! Check required fields.');
            }
        }

        function runTest(testType) {
            showResult('info', `üß™ Running Test: ${testType}`);

            switch(testType) {
                case 'empty':
                    document.getElementById('customerName').value = '';
                    document.getElementById('phoneNumber').value = '';
                    document.getElementById('paymentMethod').value = 'Ti·ªÅn m·∫∑t';
                    setTimeout(() => {
                        validateAndShowData();
                        showResult('success', '‚úÖ Empty fields test completed - should auto-fill defaults');
                    }, 100);
                    break;

                case 'clear':
                    clearInput('customerName');
                    clearInput('phoneNumber');
                    setTimeout(() => {
                        validateAndShowData();
                        showResult('success', '‚úÖ Clear buttons test completed - should show defaults');
                    }, 100);
                    break;

                case 'manual':
                    document.getElementById('customerName').value = 'Nguy·ªÖn VƒÉn A';
                    document.getElementById('phoneNumber').value = '0901234567';
                    document.getElementById('paymentMethod').value = 'Chuy·ªÉn kho·∫£n';
                    setTimeout(() => {
                        validateAndShowData();
                        showResult('success', '‚úÖ Manual input test completed - should keep custom values');
                    }, 100);
                    break;

                case 'validation':
                    document.getElementById('customerName').value = 'Kh√°ch l·∫ª';
                    document.getElementById('phoneNumber').value = 'Kh√¥ng c√≥';
                    document.getElementById('paymentMethod').value = '';
                    setTimeout(() => {
                        validateAndShowData();
                        showResult('warning', '‚ö†Ô∏è Validation test completed - should fail due to missing payment method');
                    }, 100);
                    break;
            }
        }

        function showResult(type, message) {
            const resultsDiv = document.getElementById('testResults');
            const resultEl = document.createElement('div');
            resultEl.className = `test-result ${type}`;
            resultEl.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            resultsDiv.appendChild(resultEl);

            // Auto scroll to bottom
            resultEl.scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            showResult('success', 'üöÄ Test environment initialized');
            showResult('info', 'üìù Default values: customerName="Kh√°ch l·∫ª", phoneNumber="Kh√¥ng c√≥"');
            showResult('info', 'üéØ Customer name is NOT required anymore');
        });

        // Add blur event listeners (like in real pos.js)
        ['customerName', 'phoneNumber'].forEach(fieldId => {
            const field = document.getElementById(fieldId);
            if (field) {
                field.addEventListener('blur', () => {
                    if (fieldId === 'customerName' && !field.value.trim()) {
                        field.value = 'Kh√°ch l·∫ª';
                        showResult('info', 'üîÑ Auto-filled customerName with "Kh√°ch l·∫ª"');
                    }
                    if (fieldId === 'phoneNumber' && !field.value.trim()) {
                        field.value = 'Kh√¥ng c√≥';
                        showResult('info', 'üîÑ Auto-filled phoneNumber with "Kh√¥ng c√≥"');
                    }
                });
            }
        });
    </script>
</body>
</html>
