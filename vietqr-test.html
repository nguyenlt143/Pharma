<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VietQR Test - Pharmacy Payment</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-input, .form-select {
            width: 100%;
            max-width: 300px;
            height: 40px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .qr-code-section {
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px dashed #94a3b8;
            border-radius: 12px;
            text-align: center;
        }

        .qr-code-container {
            margin: 20px 0;
            display: flex;
            justify-content: center;
        }

        .qr-placeholder {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
        }

        .qr-code-img {
            width: 200px;
            height: 200px;
            border-radius: 8px;
        }

        .qr-bank-info {
            margin-top: 16px;
            padding: 12px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            border: 1px solid #3b82f6;
        }

        .bank-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 14px;
            color: #1e293b;
        }

        .qr-amount-display {
            margin-top: 12px;
            padding: 12px;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 8px;
            border: 1px solid #22c55e;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .generate-btn {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }

        .generate-btn:hover {
            background: #4338ca;
        }

        .url-display {
            background: #f3f4f6;
            padding: 12px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            margin-top: 10px;
        }

        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }

        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #b6d7db; }

        @media (max-width: 768px) {
            .bank-info-grid {
                grid-template-columns: 1fr;
            }

            .control-panel {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>üè¶ VietQR Test - Pharmacy Payment System</h1>

    <div class="status info">
        <strong>Status:</strong> <span id="testStatus">Ready to test</span>
    </div>

    <div class="test-container">
        <h2>VietQR Configuration</h2>

        <div class="control-panel">
            <div class="form-group">
                <label class="form-label">Bank Code</label>
                <select class="form-select" id="bankCode">
                    <option value="VCB">VCB - Vietcombank</option>
                    <option value="TCB">TCB - Techcombank</option>
                    <option value="VTB">VTB - Vietinbank</option>
                    <option value="BIDV">BIDV - BIDV</option>
                    <option value="ACB">ACB - ACB</option>
                    <option value="MB">MB - MBBank</option>
                    <option value="TPB">TPB - TPBank</option>
                    <option value="STB">STB - Sacombank</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Account Number</label>
                <input type="text" class="form-input" id="accountNumber" value="0123456789" placeholder="S·ªë t√†i kho·∫£n">
            </div>

            <div class="form-group">
                <label class="form-label">Amount (VNƒê)</label>
                <input type="number" class="form-input" id="amount" value="70000" placeholder="S·ªë ti·ªÅn">
            </div>

            <div class="form-group">
                <label class="form-label">Note/Message</label>
                <input type="text" class="form-input" id="addInfo" value="HD23001" placeholder="Ghi ch√∫/M√£ h√≥a ƒë∆°n">
            </div>
        </div>

        <button class="generate-btn" onclick="generateVietQR()">Generate VietQR Code</button>

        <div id="urlDisplay" class="url-display" style="display: none;"></div>
    </div>

    <div class="test-container">
        <h2>Generated QR Code</h2>

        <div class="qr-code-section">
            <div class="qr-code-container">
                <div class="qr-placeholder">
                    <img id="qrCodeImage"
                         src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSJ3aGl0ZSIvPgo8dGV4dCB4PSIxMDAiIHk9IjEwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzMzMzMzMyIgZm9udC1zaXplPSIxNiI+VmlldFFSPC90ZXh0Pgo8dGV4dCB4PSIxMDAiIHk9IjEyMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzY2NjY2NiIgZm9udC1zaXplPSIxMiI+Q2xpY2sgR2VuZXJhdGU8L3RleHQ+CjwvYSB2Zz4K"
                         alt="QR Code Placeholder"
                         class="qr-code-img">
                </div>
            </div>

            <div class="qr-bank-info">
                <div class="bank-info-grid">
                    <div><strong>Ng√¢n h√†ng:</strong> <span id="displayBank">-</span></div>
                    <div><strong>S·ªë TK:</strong> <span id="displayAccount">-</span></div>
                    <div><strong>T√™n TK:</strong> Nh√† Thu·ªëc ABC</div>
                    <div><strong>N·ªôi dung:</strong> <span id="displayNote">-</span></div>
                </div>
            </div>

            <div class="qr-amount-display">
                <strong style="color: #1e293b; font-size: 16px;">T·ªïng ti·ªÅn: <span id="displayAmount">0</span> VNƒê</strong>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>Test Examples</h2>
        <p><strong>V√≠ d·ª• theo y√™u c·∫ßu:</strong></p>
        <ul>
            <li><strong>Bank:</strong> VCB</li>
            <li><strong>Account:</strong> 0123456789</li>
            <li><strong>Amount:</strong> 70000</li>
            <li><strong>Note:</strong> HD23001</li>
        </ul>
        <p><strong>URL ƒë∆∞·ª£c t·∫°o:</strong> <code>https://img.vietqr.io/VCB/0123456789?amount=70000&addInfo=HD23001</code></p>

        <div style="margin-top: 16px;">
            <button class="generate-btn" onclick="loadExample()">Load Example</button>
        </div>
    </div>

    <script>
        function generateVietQR() {
            const bankCode = document.getElementById('bankCode').value;
            const accountNumber = document.getElementById('accountNumber').value.trim();
            const amount = parseInt(document.getElementById('amount').value) || 0;
            const addInfo = document.getElementById('addInfo').value.trim();

            if (!bankCode || !accountNumber || amount <= 0) {
                updateStatus('error', 'Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                return;
            }

            // Generate VietQR URL
            let vietQRUrl = `https://img.vietqr.io/${bankCode}/${accountNumber}?amount=${amount}`;
            if (addInfo) {
                vietQRUrl += `&addInfo=${encodeURIComponent(addInfo)}`;
            }

            // Update displays
            const qrCodeImage = document.getElementById('qrCodeImage');
            const urlDisplay = document.getElementById('urlDisplay');

            // Show URL
            urlDisplay.textContent = vietQRUrl;
            urlDisplay.style.display = 'block';

            // Update bank info displays
            document.getElementById('displayBank').textContent = getBankName(bankCode);
            document.getElementById('displayAccount').textContent = accountNumber;
            document.getElementById('displayNote').textContent = addInfo || '-';
            document.getElementById('displayAmount').textContent = amount.toLocaleString('vi-VN');

            // Load QR image
            qrCodeImage.src = vietQRUrl;
            qrCodeImage.onload = function() {
                updateStatus('success', `VietQR generated successfully! Bank: ${bankCode}, Amount: ${amount.toLocaleString('vi-VN')} VNƒê`);
            };
            qrCodeImage.onerror = function() {
                updateStatus('error', 'Failed to load VietQR image. Please check your parameters.');
                console.error('VietQR URL failed:', vietQRUrl);
            };
        }

        function getBankName(code) {
            const banks = {
                'VCB': 'Vietcombank (VCB)',
                'TCB': 'Techcombank (TCB)',
                'VTB': 'Vietinbank (VTB)',
                'BIDV': 'BIDV',
                'ACB': 'ACB',
                'MB': 'MBBank (MB)',
                'TPB': 'TPBank (TPB)',
                'STB': 'Sacombank (STB)'
            };
            return banks[code] || code;
        }

        function updateStatus(type, message) {
            const statusEl = document.getElementById('testStatus');
            const statusContainer = statusEl.parentElement;

            statusContainer.className = `status ${type}`;
            statusEl.textContent = message;
        }

        function loadExample() {
            document.getElementById('bankCode').value = 'VCB';
            document.getElementById('accountNumber').value = '0123456789';
            document.getElementById('amount').value = '70000';
            document.getElementById('addInfo').value = 'HD23001';

            generateVietQR();
        }

        // Auto-generate on input change
        document.querySelectorAll('input, select').forEach(input => {
            input.addEventListener('input', () => {
                if (document.getElementById('urlDisplay').style.display !== 'none') {
                    generateVietQR();
                }
            });
        });

        console.log('VietQR Test page initialized');
    </script>
</body>
</html>
